/*
 * gitGraph.js
 *
 * Author: Sander Blue - http://www.sanderblue.com
 * Copyright (c) 2013, Sander Blue All rights reserved.
 *
 * Thanks to Morris.js and Moment.js
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software
 * is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */(function(e){var t=this;e.fn.gitGraph=function(t){return this.each(function(){if(undefined==e(this).data("gitGraph")){var n=new e.gitGraph(this,t);e(this).data("gitGraph",n)}})};e.gitGraph=function(t,n){var r=this,i=t,s={html:n.html,user:n.user,repo:n.repo,commits:[]},o="https://api.github.com/repos/"+s.user+"/"+s.repo+"/stats/commit_activity",u=function(){return e.ajax({url:o,type:"GET",contentType:"json",dataType:"json"})};e.when(u()).done(function(t,o){if(e.isEmptyObject(t)){console.log(i);var u=e(i).height(),a=e(i).width(),f=e(i).attr("id");e(i).append("Something wasn't quite right. The data set was empty! Please try again.")}var l=t[51].days,c=t[50].days,h=c.concat(l),p=(new Date).getDay(),d=new Array(7);d[0]=moment().utc().format("ddd");d[1]=moment().utc().add("days",6).format("ddd");d[2]=moment().utc().add("days",5).format("ddd");d[3]=moment().utc().add("days",4).format("ddd");d[4]=moment().utc().add("days",3).format("ddd");d[5]=moment().utc().add("days",2).format("ddd");d[6]=moment().utc().add("days",1).format("ddd");var v=new Array(7);v[0]=moment().utc().format("d");v[1]=moment().utc().add("days",1).format("d");v[2]=moment().utc().add("days",2).format("d");v[3]=moment().utc().add("days",3).format("d");v[4]=moment().utc().add("days",4).format("d");v[5]=moment().utc().add("days",5).format("d");v[6]=moment().utc().add("days",6).format("d");var m=new Array(7);m[0]=moment().utc().format("d");m[1]=moment().utc().add("days",1).format("d");m[2]=moment().utc().add("days",2).format("d");m[3]=moment().utc().add("days",3).format("d");m[4]=moment().utc().add("days",4).format("d");m[5]=moment().utc().add("days",5).format("d");m[6]=moment().utc().add("days",6).format("d");var g=m.concat(v),y=g.slice(p,p+7),b=h.slice(p+1,p+8),w=[],E={g:w};e.each(b,function(e,t){w.push(t)});var S=[{dayOfWeek:d[6],commits:E.g[0]},{dayOfWeek:d[5],commits:E.g[1]},{dayOfWeek:d[4],commits:E.g[2]},{dayOfWeek:d[3],commits:E.g[3]},{dayOfWeek:d[2],commits:E.g[4]},{dayOfWeek:d[1],commits:E.g[5]},{dayOfWeek:d[0],commits:E.g[6]}];r.settings={};var x=e(i),T=i;r.init=function(){r.settings=e.extend({},s,n);return this,Morris.Line({element:s.html,data:S,xkey:"dayOfWeek",ykeys:["commits"],labels:["commits"],lineWidth:1.75,lineColors:["#479201"],pointSize:2.75,pointWidths:[1],pointStrokeColors:["#ffffff"],smooth:!0,continuousLine:!0,hideHover:!0,gridTextSize:10,parseTime:!1})};r.init()}).fail(function(t,n,r){i.innerHTML===""&&e(i).append("There was a issue retrieving the data, please try again.")})}})(jQuery);